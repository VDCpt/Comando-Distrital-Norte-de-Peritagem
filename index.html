<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="VDC Forense - Sistema de Peritagem Digital v12.8 SYNC SCHEMA">
    <title>VDC FORENSE - v12.8 SYNC SCHEMA (CONSOLIDA√á√ÉO FINAL)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- BARREIRA DE ENTRADA - ACESSO RESTRITO -->
    <div id="barrier-window" class="modal-overlay">
        <div class="modal-content barrier-box">
            <div class="modal-header">
                <div class="security-badge">ACESSO RESTRITO ¬∑ N√çVEL 4</div>
                <h2>VDC FORENSE v12.8</h2>
                <p>Sistema de Auditoria Digital e An√°lise Fiscal ¬∑ SYNC SCHEMA</p>
            </div>
            <div class="modal-body">
                <div class="perito-info">
                    <p><strong>ANALISTA:</strong> EDUARDO ¬∑ PERITO FORENSE DIGITAL</p>
                    <p><strong>ENTIDADE:</strong> CONSULTORIA DE GEST√ÉO E I&D</p>
                    <p><strong>ALVO:</strong> AUDITORIA ECON√ìMICO-FINANCEIRA ¬∑ DAC7/SAF-T</p>
                </div>
                <p class="disclaimer">O sistema ir√° processar fontes brutas (PDF, CSV, XML) para gera√ß√£o de prova legal de autenticidade (SHA-256) e cruzamento de dados fiscais. Todas as opera√ß√µes s√£o registadas na cadeia de cust√≥dia.</p>
                <div class="auth-hash" id="session-id-display">
                    <span class="hash-label">HASH DA SESS√ÉO:</span>
                    <span class="hash-value">---</span>
                </div>
            </div>
            <div class="modal-footer">
                <button id="btn-proceed" class="btn-primary-glow">VALIDAR ACESSO E INICIAR SESS√ÉO</button>
            </div>
        </div>
    </div>

    <!-- APLICA√á√ÉO PRINCIPAL (INICIALMENTE OCULTA) -->
    <div id="app-container" class="hidden">
        <header class="main-header">
            <div class="brand">
                <div class="logo-icon">VDC</div>
                <div class="brand-text">
                    <h1>SISTEMA <span>SYNC SCHEMA</span> <span class="version-badge">v12.8</span></h1>
                    <div class="session-info">SESS√ÉO: <span id="session-id">---</span> | <span id="session-time">00:00:00</span> | <span class="status-online">ONLINE</span></div>
                </div>
            </div>
            <div class="header-actions">
                <button id="btn-demo" class="btn-tool">CARREGAR DEMO</button>
                <button id="btn-export-json" class="btn-tool">EXPORTAR JSON</button>
                <button id="btn-clear" class="btn-tool btn-tool-danger">LIMPAR SISTEMA</button>
            </div>
        </header>

        <main class="dashboard-grid">
            <!-- SIDEBAR ESQUERDA - CONSOLA E UPLOAD -->
            <aside class="sidebar">
                <!-- CONSOLA DE AUDITORIA -->
                <section class="card console-card">
                    <div class="card-header">
                        <h3>CONSOLA DE AUDITORIA ¬∑ CADEIA DE CUST√ìDIA</h3>
                        <span class="status-dot pulse"></span>
                    </div>
                    <div id="audit-console" class="terminal-box">
                        <div class="line green">[SISTEMA] A aguardar fontes de dados...</div>
                        <div class="line blue">[INFO] Utilize a zona de upload para anexar documentos</div>
                    </div>
                </section>

                <!-- ZONA DE UPLOAD - FONTES DE DADOS -->
                <section class="card upload-card">
                    <h3>FONTES DE DADOS ¬∑ UPLOAD</h3>
                    <div class="drop-zone" id="drop-zone">
                        <span class="drop-icon">üìÅ</span>
                        <p>Arraste ficheiros ou clique para selecionar</p>
                        <small>Formatos suportados: PDF, CSV, XML (m√°x. 10MB)</small>
                        <input type="file" id="file-input" multiple accept=".pdf,.csv,.xml,application/pdf,text/csv" hidden>
                    </div>
                    <div id="file-queue" class="file-list-mini">
                        <!-- Ficheiros ser√£o listados aqui dinamicamente -->
                    </div>
                    <div class="evidence-summary">
                        <div class="evidence-item" data-tipo="ctrl">
                            <span class="count" id="count-ctrl">0</span>
                            <span class="label">CTRL</span>
                        </div>
                        <div class="evidence-item" data-tipo="saft">
                            <span class="count" id="count-saft">0</span>
                            <span class="label">SAF-T</span>
                        </div>
                        <div class="evidence-item" data-tipo="fat">
                            <span class="count" id="count-fat">0</span>
                            <span class="label">FAT</span>
                        </div>
                        <div class="evidence-item" data-tipo="ext">
                            <span class="count" id="count-ext">0</span>
                            <span class="label">EXT</span>
                        </div>
                        <div class="evidence-item" data-tipo="dac7">
                            <span class="count" id="count-dac7">0</span>
                            <span class="label">DAC7</span>
                        </div>
                    </div>
                </section>
            </aside>

            <!-- CONTE√öDO PRINCIPAL - M√âTRICAS E RESULTADOS -->
            <section class="main-content">
                <!-- M√âTRICAS PRINCIPAIS -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <label>RECEITA BRUTA (SAF-T)</label>
                        <div class="value positive" id="val-bruto">0,00 ‚Ç¨</div>
                    </div>
                    <div class="metric-card">
                        <label>GANHOS L√çQUIDOS (BOLT)</label>
                        <div class="value positive" id="val-liquido">0,00 ‚Ç¨</div>
                    </div>
                    <div class="metric-card">
                        <label>RECEITA ANUAL (DAC7)</label>
                        <div class="value positive" id="val-dac7">0,00 ‚Ç¨</div>
                    </div>
                </div>

                <!-- M√âTRICAS SECUND√ÅRIAS -->
                <div class="metrics-grid secondary">
                    <div class="metric-card small">
                        <label>COMISS√ïES TOTAIS</label>
                        <div class="value" id="val-comissoes">0,00 ‚Ç¨</div>
                    </div>
                    <div class="metric-card small">
                        <label>N.¬∫ VIAGENS</label>
                        <div class="value" id="val-viagens">0</div>
                    </div>
                    <div class="metric-card small">
                        <label>TAXA M√âDIA</label>
                        <div class="value" id="val-taxa">0,00%</div>
                    </div>
                </div>

                <!-- PAINEL DE RESULTADOS COM TABS -->
                <div class="card results-card">
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="tab-autenticidade">CONTROLO DE AUTENTICIDADE (SHA-256)</button>
                        <button class="tab-btn" data-tab="tab-financeiro">CRUZAMENTO FINANCEIRO</button>
                        <button class="tab-btn" data-tab="tab-dac7">RELAT√ìRIO DAC7</button>
                        <button class="tab-btn" data-tab="tab-veredito">VEREDITO FISCAL</button>
                    </div>

                    <!-- TAB 1: AUTENTICIDADE / HASHES -->
                    <div class="tab-content" id="tab-autenticidade">
                        <div class="table-wrapper">
                            <table id="table-hashes">
                                <thead>
                                    <tr>
                                        <th>ALGORITMO</th>
                                        <th>HASH CALCULADO (SHA-256)</th>
                                        <th>FICHEIRO ORIGEM</th>
                                        <th>ESTADO</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Linhas inseridas via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="table-footer">
                            <span class="hash-verified">‚úì Todos os ficheiros verificados por hash</span>
                        </div>
                    </div>

                    <!-- TAB 2: CRUZAMENTO FINANCEIRO -->
                    <div class="tab-content hidden" id="tab-financeiro">
                        <div class="table-wrapper">
                            <table id="table-viagens">
                                <thead>
                                    <tr>
                                        <th>DATA</th>
                                        <th>MOTORISTA</th>
                                        <th>N.¬∫ FATURA</th>
                                        <th>VALOR (‚Ç¨)</th>
                                        <th>COMISS√ÉO (‚Ç¨)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Linhas inseridas via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        <div class="triangulacao-financeira">
                            <h4>TRIANGULA√á√ÉO FINANCEIRA</h4>
                            <div class="triangulacao-grid">
                                <div class="tri-item">
                                    <span>BRUTO APP</span>
                                    <strong id="tri-bruto">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="tri-item">
                                    <span>COMISS√ïES</span>
                                    <strong id="tri-comissoes">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="tri-item">
                                    <span>L√çQUIDO</span>
                                    <strong id="tri-liquido">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="tri-item">
                                    <span>FATURADO</span>
                                    <strong id="tri-faturado">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="tri-item discrepancia" id="tri-discrepancia-item" style="display: none;">
                                    <span>DISCREP√ÇNCIA</span>
                                    <strong id="tri-discrepancia">0,00 ‚Ç¨</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB 3: RELAT√ìRIO DAC7 -->
                    <div class="tab-content hidden" id="tab-dac7">
                        <div class="dac7-container">
                            <div class="dac7-header">
                                <h4>DECLARA√á√ÉO ANUAL ¬∑ DIRETIVA DAC7</h4>
                                <span class="dac7-badge">ART. 6.¬∫</span>
                            </div>
                            <div class="dac7-content">
                                <div class="dac7-row">
                                    <span>RECEITA TOTAL DECLARADA:</span>
                                    <strong id="dac7-receita">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="dac7-row">
                                    <span>COMISS√ïES TOTAIS:</span>
                                    <strong id="dac7-comissoes">0,00 ‚Ç¨</strong>
                                </div>
                                <div class="dac7-row">
                                    <span>SERVI√áOS PRESTADOS:</span>
                                    <strong id="dac7-servicos">0</strong>
                                </div>
                                <div class="dac7-row">
                                    <span>PER√çODO DECLARADO:</span>
                                    <strong id="dac7-periodo">2024</strong>
                                </div>
                            </div>
                            <div class="dac7-trimestres">
                                <h5>DETALHES TRIMESTRAIS</h5>
                                <div class="trimestres-grid">
                                    <div class="trimestre-card">
                                        <span class="trimestre-label">1.¬∫ TRIMESTRE</span>
                                        <span class="trimestre-value" id="dac7-1t">0,00 ‚Ç¨</span>
                                    </div>
                                    <div class="trimestre-card">
                                        <span class="trimestre-label">2.¬∫ TRIMESTRE</span>
                                        <span class="trimestre-value" id="dac7-2t">0,00 ‚Ç¨</span>
                                    </div>
                                    <div class="trimestre-card">
                                        <span class="trimestre-label">3.¬∫ TRIMESTRE</span>
                                        <span class="trimestre-value" id="dac7-3t">0,00 ‚Ç¨</span>
                                    </div>
                                    <div class="trimestre-card">
                                        <span class="trimestre-label">4.¬∫ TRIMESTRE</span>
                                        <span class="trimestre-value" id="dac7-4t">0,00 ‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB 4: VEREDITO FISCAL -->
                    <div class="tab-content hidden" id="tab-veredito">
                        <div class="veredicto-section" id="veredicto-section">
                            <div class="veredicto-header">
                                <h2>VEREDITO FISCAL ¬∑ TRIANGULA√á√ÉO</h2>
                                <div class="veredicto-status" id="veredicto-status">NORMAL</div>
                                <div class="veredicto-desvio" id="veredicto-desvio">Sem desvios significativos</div>
                            </div>
                            <div class="anomalia-critica" id="anomalia-critica" style="display: none;">
                                <span class="icon-warning">‚ö†</span>
                                <div>
                                    <strong>ANOMALIA CR√çTICA DETETADA</strong>
                                    <p id="anomalia-texto">Potencial incumprimento fiscal (Art. 103.¬∫ RGIT)</p>
                                    <span class="valor-anomalia" id="valor-anomalia">0,00 ‚Ç¨</span>
                                </div>
                            </div>
                            <div class="recomendacoes">
                                <h4>RECOMENDA√á√ïES T√âCNICAS</h4>
                                <ul id="recomendacoes-lista">
                                    <li>Validar concilia√ß√£o banc√°ria dos valores declarados</li>
                                    <li>Verificar reten√ß√µes na fonte e IVA</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ALERTAS DIN√ÇMICOS -->
                <div id="alertas-container" class="alertas-container"></div>
            </section>
        </main>

        <footer class="main-footer">
            <div class="status-bar">
                <span><strong>ESTADO:</strong> <span id="system-status" class="status-ok">OPERACIONAL</span></span>
                <span><strong>SESS√ÉO:</strong> <span id="footer-session">---</span></span>
                <span><strong>VERS√ÉO:</strong> 12.8.0-FINAL ¬∑ SYNC SCHEMA</span>
                <span><strong>PERITO:</strong> EDUARDO ¬∑ <span id="footer-time"></span></span>
            </div>
        </footer>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
