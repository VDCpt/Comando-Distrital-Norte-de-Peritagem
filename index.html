<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDC FORENSE v12.6 | CYBER CYAN EDITION</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ================================== -->
    <!-- SPLASH SCREEN -->
    <!-- ================================== -->
    <div id="splashScreen" class="splash-screen">
        <div class="laser-h"></div>
        <div class="laser-v"></div>
        <div class="splash-content">
            <div class="splash-logo"><i class="fas fa-shield-virus"></i></div>
            <h1>VDC FORENSE</h1>
            <h2>CYBER CYAN EDITION · v12.6</h2>
            <div class="splash-warning-box">
                <p><i class="fas fa-terminal"></i> PROTOCOLO DE LEITURA UNIVERSAL</p>
                <small>Sistema preparado para processamento de Big Data e cruzamento de evidências múltiplas.</small>
            </div>
            <button id="startSessionBtn" class="splash-btn">
                <i class="fas fa-power-off"></i> INICIAR PERÍCIA
            </button>
        </div>
    </div>

    <!-- ================================== -->
    <!-- MAIN CONTAINER -->
    <!-- ================================== -->
    <div id="mainContainer" class="main-container">
        
        <!-- HEADER -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo-section">
                    <i class="fas fa-fingerprint"></i>
                    <h1>VDC SYSTEM <span class="version-badge">v12.6</span></h1>
                </div>
                <div class="session-info">
                    <span id="sessionIdDisplay">------------</span>
                </div>
                <div class="control-group">
                    <button id="demoModeBtn" class="btn-demo">CASO SIMULADO</button>
                    <button id="openEvidenceModalBtn" class="btn-evidence">EVIDÊNCIAS <span class="badge" id="fileCountBadge">0</span></button>
                </div>
            </div>
        </header>

        <!-- APP CONTAINER -->
        <div class="app-layout">
            
            <!-- SIDEBAR -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3><i class="fas fa-user-shield"></i> IDENTIFICAÇÃO</h3>
                    <input type="text" id="clientName" placeholder="Nome do Sujeito Passivo" class="input-field">
                    <input type="text" id="clientNIF" placeholder="NIF" class="input-field" maxlength="9">
                    <button id="registerClientBtn" class="btn-cyan">VALIDAR</button>
                    <div id="clientStatus" class="status-box" style="display:none;"></div>
                </div>
                
                <div class="sidebar-section">
                    <h3><i class="fas fa-cog"></i> PARÂMETROS</h3>
                    <select id="yearSelect" class="input-field"></select>
                    <select id="platformSelect" class="input-field">
                        <option value="bolt">Bolt</option>
                        <option value="uber">Uber</option>
                        <option value="freenow">FreeNow</option>
                        <option value="indrive">inDrive</option>
                    </select>
                </div>

                <button id="analyzeBtn" class="btn-execute">
                    <i class="fas fa-crosshairs"></i> EXECUTAR CRUZAMENTO
                </button>
            </aside>

            <!-- ÁREA DE ANÁLISE -->
            <main class="analysis-area">
                
                <!-- GRID DE MÓDULOS (DUAS JANELAS LADO A LADO) -->
                <div class="modules-grid">
                    
                    <!-- JANELA A: MÓDULO SAF-T -->
                    <div class="module-card">
                        <div class="card-header">
                            <i class="fas fa-file-code"></i> MÓDULO SAF-T (EXTRAÇÃO)
                        </div>
                        <div class="card-body">
                            <div class="data-row">
                                <span class="label">Bruto Declarado</span>
                                <span class="value" id="saftBruto">0,00 €</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Comissões Declaradas</span>
                                <span class="value" id="saftComissoes">0,00 €</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Líquido Declarado</span>
                                <span class="value" id="saftLiquido">0,00 €</span>
                            </div>
                            <div class="data-row highlight">
                                <span class="label">Total Faturado (Doc)</span>
                                <span class="value bold" id="saftFaturado">0,00 €</span>
                            </div>
                        </div>
                    </div>

                    <!-- JANELA B: MÓDULO EXTRATOS -->
                    <div class="module-card">
                        <div class="card-header">
                            <i class="fas fa-file-invoice-dollar"></i> MÓDULO EXTRATOS (MAPEAMENTO)
                        </div>
                        <div class="card-body">
                            <div class="data-row">
                                <span class="label">Bruto Real (Depósitos)</span>
                                <span class="value" id="extBruto">0,00 €</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Comissões Reais (Taxas)</span>
                                <span class="value alert" id="extComissoes">0,00 €</span>
                            </div>
                            <div class="data-row">
                                <span class="label">Líquido Real (App)</span>
                                <span class="value" id="extLiquido">0,00 €</span>
                            </div>
                            <div class="data-row highlight">
                                <span class="label">Discrepância Cruzada</span>
                                <span class="value bold alert" id="extFaturado">0,00 €</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- VEREDICTO & QUANTUM -->
                <div id="verdictBox" class="verdict-box">
                    <h3>ANÁLISE DE RISCO</h3>
                    <p id="verdictText">AGUARDANDO DADOS</p>
                    <p id="verdictDesc">Introduza ficheiros para iniciar a perícia.</p>
                </div>

                <!-- TOOLBAR -->
                <div class="toolbar">
                    <button id="exportPDFBtn" class="btn-tool" disabled>
                        <i class="fas fa-file-pdf"></i> PARECER PDF
                    </button>
                    <button id="clearBtn" class="btn-tool">
                        <i class="fas fa-trash"></i> LIMPAR
                    </button>
                </div>

                <!-- CONSOLA -->
                <div class="console-container">
                    <div class="console-header">LOG DE CUSTÓDIA</div>
                    <div id="consoleOutput" class="console-output"></div>
                </div>

            </main>
        </div>
    </div>

    <!-- MODAL DE EVIDÊNCIAS -->
    <div id="evidenceModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-folder-open"></i> GESTÃO DE EVIDÊNCIAS DIGITAIS</h2>
                <button id="closeModalBtn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                
                <!-- Upload SAF-T -->
                <div class="upload-section">
                    <button id="uploadSaftBtn" class="upload-btn"><i class="fas fa-upload"></i> CARREGAR SAF-T (XML/CSV)</button>
                    <input type="file" id="inputSaft" accept=".xml,.csv,.txt" hidden multiple>
                    <!-- LISTA VISÍVEL -->
                    <div id="saftFileList" class="file-list"></div>
                </div>

                <!-- Upload Faturas -->
                <div class="upload-section">
                    <button id="uploadInvoiceBtn" class="upload-btn"><i class="fas fa-upload"></i> CARREGAR FATURAS (PDF/CSV)</button>
                    <input type="file" id="inputInvoice" accept=".pdf,.csv,.xml" hidden multiple>
                    <!-- LISTA VISÍVEL -->
                    <div id="invoiceFileList" class="file-list"></div>
                </div>

                <!-- Upload Extratos -->
                <div class="upload-section">
                    <button id="uploadStatementBtn" class="upload-btn"><i class="fas fa-upload"></i> CARREGAR EXTRATOS (CSV/XLS)</button>
                    <input type="file" id="inputStatement" accept=".csv,.xls,.xlsx,.pdf" hidden multiple>
                    <!-- LISTA VISÍVEL -->
                    <div id="statementFileList" class="file-list"></div>
                </div>

            </div>
            <div class="modal-footer">
                <button id="sealEvidenceBtn" class="btn-cyan">SELAR EVIDÊNCIAS</button>
            </div>
        </div>
    </div>

    <!-- TOASTS -->
    <div id="toastContainer"></div>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
