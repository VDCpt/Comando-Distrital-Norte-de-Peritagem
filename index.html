<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDC FORENSE - v12.8 CSI MIAMI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-tertiary: #1f2937;
            --accent-cyan: #06b6d4;
            --accent-cyan-glow: rgba(6, 182, 212, 0.3);
            --text-primary: #f9fafb;
            --text-secondary: #9ca3af;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(6, 182, 212, 0.3);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="loading-screen" id="loading-screen">
        <div class="spinner"></div>
    </div>
    
    <div class="app-container" id="app-container" style="display: none;">
        <!-- HEADER -->
        <header class="main-header">
            <div class="brand">
                <div class="logo">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                        <path d="M2 17l10 5 10-5"/>
                        <path d="M2 12l10 5 10-5"/>
                    </svg>
                </div>
                <div class="brand-text">
                    <h1>VDC FORENSE <span class="version">v12.8</span></h1>
                    <p>ISO/IEC 27037 | NIST SP 800-86 | Interpol Digital Forensics</p>
                </div>
            </div>
            <div class="session-info">
                <div class="badge simulated">CASO SIMULADO</div>
                <div class="session-id">
                    <span>SESS√ÉO: <span id="session-id">CARREGANDO...</span></span>
                    <span id="session-time">--/--/---- | --:--:--</span>
                </div>
            </div>
        </header>

        <!-- MAIN LAYOUT -->
        <div class="main-layout">
            <!-- SIDEBAR -->
            <aside class="sidebar">
                <!-- PAINEL: IDENTIFICA√á√ÉO DO SUJEITO -->
                <section class="panel subject-panel">
                    <h3>IDENTIFICA√á√ÉO DO SUJEITO</h3>
                    <div class="form-group">
                        <label for="subject-name">NOME / EMPRESA</label>
                        <input type="text" id="subject-name" value="Momento Lda" placeholder="Nome ou Empresa">
                    </div>
                    <div class="form-group">
                        <label for="subject-nif">NIF</label>
                        <input type="text" id="subject-nif" value="517905450" placeholder="NIF" maxlength="9">
                    </div>
                    <button class="btn-validate" id="btn-validar" type="button">
                        <span class="icon">‚úì</span> VALIDAR
                    </button>
                    <div class="validation-status" id="validation-status">
                        <span class="status-dot"></span>
                        <span>Aguardando valida√ß√£o...</span>
                    </div>
                </section>

                <!-- PAINEL: PAR√ÇMETROS -->
                <section class="panel parameters-panel">
                    <h3>PAR√ÇMETROS</h3>
                    <div class="form-group">
                        <label for="ano-fiscal">ANO FISCAL</label>
                        <select id="ano-fiscal">
                            <option value="2024" selected>2024</option>
                            <option value="2023">2023</option>
                            <option value="2022">2022</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="periodo">PER√çODO</label>
                        <select id="periodo">
                            <option value="1">1.¬∫ Semestre</option>
                            <option value="2" selected>2.¬∫ Semestre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="plataforma">PLATAFORMA</label>
                        <select id="plataforma">
                            <option value="bolt" selected>Bolt (Est√≥nia)</option>
                            <option value="uber">Uber (EUA)</option>
                            <option value="free">Free Now (Alemanha)</option>
                        </select>
                    </div>
                </section>

                <!-- PAINEL: GEST√ÉO DE EVID√äNCIAS -->
                <section class="panel evidence-panel">
                    <h3>
                        <button class="btn-toggle-evidence" id="btn-toggle-evidence" type="button">
                            GEST√ÉO DE EVID√äNCIAS
                            <span class="badge-count" id="total-evidencias">0</span>
                        </button>
                    </h3>
                    <div class="evidence-summary">
                        <div class="evidence-item" data-tipo="ctrl">
                            <span class="count" id="count-ctrl">0</span>
                            <span class="label">CTRL</span>
                        </div>
                        <div class="evidence-item" data-tipo="saft">
                            <span class="count" id="count-saft">0</span>
                            <span class="label">SAF-T</span>
                        </div>
                        <div class="evidence-item" data-tipo="fat">
                            <span class="count" id="count-fat">0</span>
                            <span class="label">FAT</span>
                        </div>
                        <div class="evidence-item" data-tipo="ext">
                            <span class="count" id="count-ext">0</span>
                            <span class="label">EXT</span>
                        </div>
                        <div class="evidence-item" data-tipo="dac7">
                            <span class="count" id="count-dac7">0</span>
                            <span class="label">DAC7</span>
                        </div>
                    </div>
                    <div class="values-indicator">
                        <span class="dot" id="values-dot"></span>
                        <span id="total-valores">0 valor(es)</span>
                    </div>
                </section>

                <!-- PAINEL: A√á√ïES -->
                <section class="panel actions-panel">
                    <button class="btn-primary" id="btn-executar" type="button">
                        <span class="icon">üîç</span> EXECUTAR PER√çCIA
                    </button>
                    <button class="btn-secondary" id="btn-export-pdf" type="button">
                        <span class="icon">‚¨á</span> EXPORTAR PDF
                    </button>
                </section>
            </aside>

            <!-- CONTE√öDO PRINCIPAL -->
            <main class="content">
                <!-- TOOLBAR -->
                <div class="toolbar">
                    <button class="btn-tool" id="btn-export-json" type="button">
                        <span>{ }</span> EXPORTAR JSON
                    </button>
                    <button class="btn-tool" id="btn-reiniciar" type="button">
                        <span>‚Üª</span> REINICIAR
                    </button>
                    <button class="btn-tool" id="btn-limpar" type="button">
                        <span>üóë</span> LIMPAR
                    </button>
                </div>

                <!-- ALERTAS -->
                <div id="alertas-container" class="alertas-container"></div>

                <!-- RESULTADOS FORENSES -->
                <section class="results-section">
                    <h3>RESULTADOS FORENSES</h3>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <span class="label">GANHOS APP</span>
                            <span class="value positive" id="ganhos-app">0,00 ‚Ç¨</span>
                        </div>
                        <div class="metric-card">
                            <span class="label">COMISS√ïES</span>
                            <span class="value" id="comissoes-total">0,00 ‚Ç¨</span>
                        </div>
                        <div class="metric-card">
                            <span class="label">DAC7 ANUAL</span>
                            <span class="value" id="dac7-anual">0,00 ‚Ç¨</span>
                        </div>
                        <div class="metric-card">
                            <span class="label">TOTAL SAF-T</span>
                            <span class="value positive" id="total-saft">0,00 ‚Ç¨</span>
                        </div>
                    </div>
                </section>

                <!-- DETALHES GRID -->
                <div class="details-grid">
                    <!-- SAF-T -->
                    <section class="detail-card">
                        <h4>SAF-T (PT)</h4>
                        <div class="detail-content">
                            <div class="detail-row">
                                <span>VALOR L√çQUIDO</span>
                                <strong id="saft-liquido">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row autoliquidacao">
                                <span>IVA</span>
                                <strong id="saft-iva">---</strong>
                                <small>Autoliquida√ß√£o</small>
                            </div>
                            <div class="detail-row total">
                                <span>TOTAL SAF-T</span>
                                <strong id="saft-total">0,00 ‚Ç¨</strong>
                            </div>
                        </div>
                    </section>

                    <!-- EXTRATOS BOLT -->
                    <section class="detail-card">
                        <h4>EXTRATOS BOLT</h4>
                        <div class="detail-content">
                            <div class="detail-row">
                                <span>GANHOS NA APP</span>
                                <strong class="positive" id="ext-ganhos-app">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row">
                                <span>GANHOS CAMPANHA</span>
                                <strong id="ext-ganhos-campanha">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row">
                                <span>GORJETAS</span>
                                <strong id="ext-gorjetas">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row">
                                <span>PORTAGENS</span>
                                <strong id="ext-portagens">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row negative">
                                <span>TAXAS CANCEL.</span>
                                <strong id="ext-taxas-cancel">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row">
                                <span>COMISS√ïES</span>
                                <strong id="ext-comissoes">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="detail-row total">
                                <span>GANHOS L√çQUIDOS</span>
                                <strong class="positive" id="ext-ganhos-liquidos">0,00 ‚Ç¨</strong>
                            </div>
                        </div>
                    </section>

                    <!-- DAC7 -->
                    <section class="detail-card dac7-card">
                        <h4>DAC7</h4>
                        <div class="detail-content">
                            <div class="dac7-info">
                                <span class="dac7-label">REPORTING ANUAL</span>
                                <span class="dac7-value" id="dac7-valor">0,00 ‚Ç¨</span>
                            </div>
                            <div class="dac7-meta">
                                <span>Ano: <strong id="dac7-ano">2024</strong></span>
                                <span>Data limite: <strong id="dac7-limite">31/01/2025</strong></span>
                            </div>
                            <div class="dac7-note">
                                Valor reportado pela Bolt √†s autoridades fiscais (Art. 6.¬∫ DAC7)
                            </div>
                        </div>
                    </section>
                </div>

                <!-- FATURAS BOLT -->
                <section class="invoices-section">
                    <h4>FATURAS BOLT</h4>
                    <div class="invoice-grid">
                        <div class="invoice-item">
                            <span class="label">N.¬∫ FATURA</span>
                            <strong id="fat-numero">---</strong>
                        </div>
                        <div class="invoice-item">
                            <span class="label">TOTAL</span>
                            <strong class="positive" id="fat-total">0,00 ‚Ç¨</strong>
                        </div>
                        <div class="invoice-item autoliquidacao">
                            <span class="label">AUTOLIQUIDA√á√ÉO</span>
                            <strong id="fat-autoliquidacao">0,00 ‚Ç¨</strong>
                            <small>IVA - Autoliquida√ß√£o</small>
                        </div>
                    </div>
                </section>

                <!-- VEREDITO FISCAL -->
                <section class="veredicto-section" id="veredicto-section" style="display: none;">
                    <div class="veredicto-header">
                        <h2>VEREDITO FISCAL</h2>
                        <div class="veredicto-status" id="veredicto-status">NORMAL</div>
                        <div class="veredicto-desvio" id="veredicto-desvio">Desvio: 0%</div>
                    </div>
                    <div class="anomalia-critica" id="anomalia-critica" style="display: none;">
                        <span class="icon-warning">‚ö†</span>
                        <div>
                            <strong>ANOMALIA CR√çTICA</strong>
                            <p id="anomalia-texto">Ind√≠cio de fraude fiscal</p>
                            <span class="valor-anomalia" id="valor-anomalia">0,00 ‚Ç¨</span>
                        </div>
                    </div>
                    <div class="triangulacao-financeira">
                        <h4>TRIANGULA√á√ÉO FINANCEIRA</h4>
                        <div class="triangulacao-grid">
                            <div class="tri-item">
                                <span>BRUTO APP</span>
                                <strong id="tri-bruto">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="tri-item">
                                <span>COMISS√ïES</span>
                                <strong id="tri-comissoes">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="tri-item">
                                <span>L√çQUIDO</span>
                                <strong id="tri-liquido">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="tri-item" id="tri-faturado-item">
                                <span>FATURADO</span>
                                <strong id="tri-faturado">0,00 ‚Ç¨</strong>
                            </div>
                            <div class="tri-item discrepancia" id="tri-discrepancia-item" style="display: none;">
                                <span>DISCREP√ÇNCIA</span>
                                <strong id="tri-discrepancia">0,00 ‚Ç¨</strong>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- AN√ÅLISE GR√ÅFICA -->
                <section class="chart-section">
                    <h4>AN√ÅLISE GR√ÅFICA</h4>
                    <div class="chart-container">
                        <canvas id="analiseGrafica"></canvas>
                        <div id="chart-fallback" class="chart-fallback" style="display: none;">
                            <p>Dados insuficientes para gerar gr√°fico</p>
                        </div>
                    </div>
                </section>

                <!-- LOG FORENSE -->
                <section class="log-section">
                    <h4>LOG FORENSE</h4>
                    <div class="log-container" id="log-container">
                        <div class="log-entry">
                            <span class="timestamp">[--:--:--]</span>
                            <span class="icon info">‚Ñπ</span>
                            <span class="message">Sistema inicializado. Aguardando evid√™ncias...</span>
                        </div>
                    </div>
                </section>

                <!-- HASH -->
                <section class="hash-section">
                    <div class="hash-display">
                        <span class="hash-label">HASH SHA-256</span>
                        <span class="hash-value" id="hash-value">PENDENTE</span>
                    </div>
                    <div class="footer-info">
                        VDC Systems ¬© 2024/2026 | CSI MIAMI EDITION
                    </div>
                </section>
            </main>
        </div>

        <!-- MODAL: GEST√ÉO DE EVID√äNCIAS -->
        <div class="modal-overlay" id="evidence-modal" style="display: none;">
            <div class="modal evidence-manager">
                <div class="modal-header">
                    <h3>GEST√ÉO DE EVID√äNCIAS</h3>
                    <button class="btn-close" id="btn-close-modal" type="button" aria-label="Fechar">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="evidence-stats">
                        <span>Ficheiros: <strong id="modal-total-files">0</strong></span>
                        <span>Valores: <strong id="modal-total-values">0,00 ‚Ç¨</strong></span>
                    </div>

                    <!-- FATURAS BOLT -->
                    <div class="evidence-category">
                        <h4>FATURAS BOLT (PDF)</h4>
                        <div class="upload-zone" id="upload-faturas">
                            <span class="icon-upload">‚¨Ü</span>
                            <span>CLIQUE OU ARRASTE FICHEIROS AQUI</span>
                            <input type="file" id="input-faturas" multiple accept=".pdf,application/pdf">
                        </div>
                        <div class="file-list" id="lista-faturas"></div>
                        <div class="category-stats">
                            <span>Ficheiros: <strong id="stats-faturas-files">0</strong></span>
                            <span>Valores: <strong id="stats-faturas-values">0,00 ‚Ç¨</strong></span>
                        </div>
                    </div>

                    <!-- EXTRATOS BOLT -->
                    <div class="evidence-category">
                        <h4>EXTRATOS BOLT (PDF)</h4>
                        <div class="upload-zone" id="upload-extratos">
                            <span class="icon-upload">‚¨Ü</span>
                            <span>CLIQUE OU ARRASTE FICHEIROS AQUI</span>
                            <input type="file" id="input-extratos" multiple accept=".pdf,application/pdf">
                        </div>
                        <div class="file-list" id="lista-extratos"></div>
                        <div class="category-stats">
                            <span>Ficheiros: <strong id="stats-extratos-files">0</strong></span>
                            <span>Valores: <strong id="stats-extratos-values">0,00 ‚Ç¨</strong></span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-primary" id="btn-modal-fechar" type="button">
                        <span class="icon">‚úì</span> FECHAR
                    </button>
                    <button class="btn-danger" id="btn-modal-limpar" type="button">
                        <span class="icon">üóë</span> LIMPAR TUDO
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
